<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>药物详情 - MedLink</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <!-- 引入公共CSS -->
    <link rel="stylesheet" href="/css/common.css">
    <style>
        .drug-image {
            max-width: 100%;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
        }

        .card-title {
            color: #0066cc;
            font-weight: 600;
        }

        .drug-label {
            font-weight: bold;
            color: #444;
        }

        .drug-section p {
            margin-bottom: 8px;
        }

        .drug-image {
            max-width: 150px;
            max-height: 150px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            object-fit: contain;
        }
    </style>
</head>
<body class="d-flex flex-column min-vh-100">

<!-- 顶部导航 -->
<div data-include="header.html"></div>

<!-- 药物详情主体 -->
<div class="container mt-4">
    <div class="card p-4 d-flex flex-row align-items-center">
        <img id="drug-image" src="" alt="药物图片" class="drug-image me-4 d-none d-md-block"
             onerror="this.style.display='none'">
        <div class="flex-grow-1">
            <h3 id="drug-name" class="card-title"><i class="bi bi-capsule"></i>药物名称</h3>
            <p><i class="bi bi-tag"></i><span class="drug-label">数据库 ID：</span><span id="drug-db-id">DB12345</span></p>
            <p><i class="bi bi-globe"></i><span class="drug-label">英文名：</span><span id="drug-english-name">Drug Name</span></p>
            <p><i class="bi bi-chat-dots"></i><span class="drug-label">中文名：</span><span id="drug-chinese-name">药物名称</span></p>
        </div>
    </div>


    <!-- 详细信息卡片 -->
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card p-3 drug-section">
                <h5 class="card-title">通用名称</h5>
                <p id="drug-generic-name">暂无数据</p>
            </div>
            <div class="card p-3 drug-section">
                <h5 class="card-title">摘要</h5>
                <p id="drug-summary">暂无数据</p>
            </div>
            <div class="card p-3 drug-section">
                <h5 class="card-title">背景信息</h5>
                <p id="drug-background">暂无数据</p>
            </div>
            <div class="card p-3 drug-section">
                <h5 class="card-title">适应症</h5>
                <p id="drug-indication">暂无数据</p>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card p-3 drug-section">
                <h5 class="card-title">类型</h5>
                <p id="drug-type">暂无数据</p>
            </div>
            <div class="card p-3 drug-section">
                <h5 class="card-title">描述</h5>
                <p id="drug-description">暂无描述</p>
            </div>
            <div class="card p-3 drug-section">
                <h5 class="card-title">作用机制</h5>
                <p id="drug-mechanism">暂无信息</p>
            </div>
            <div class="card p-3 drug-section">
                <h5 class="card-title">药效动力学</h5>
                <p id="drug-pharmacodynamics">暂无数据</p>
            </div>
            <div class="card p-3 drug-section">
                <h5 class="card-title">药物分组</h5>
                <p id="drug-group">暂无分组</p>
            </div>
        </div>
    </div>
</div>

<!-- 页脚 -->
<footer class="footer mt-auto text-center">
    <div class="container">
        <p>&copy; 2025 MedLink 药物预测平台</p>
        <a href="#">关于我们</a> | <a href="#">联系我们</a>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/include.js"></script>
<script>
    const urlParams = new URLSearchParams(window.location.search);
    const drugId = urlParams.get('id');

    if (drugId) {
        fetch(`/api/drugs/${drugId}`)
            .then(res => res.json())
            .then(data => {
                document.getElementById('drug-name').textContent = data.chineseName || "未命名药物";
                document.getElementById('drug-db-id').textContent = data.dbId || "无";
                document.getElementById('drug-english-name').textContent = data.englishName || "无";
                document.getElementById('drug-chinese-name').textContent = data.chineseName || "无";
                document.getElementById('drug-generic-name').textContent = data.genericName || "暂无数据";
                document.getElementById('drug-summary').textContent = data.summary || "暂无数据";
                document.getElementById('drug-background').textContent = data.background || "暂无数据";
                document.getElementById('drug-type').textContent = data.type || "暂无数据";
                document.getElementById('drug-description').textContent = data.description || "暂无描述";
                document.getElementById('drug-indication').textContent = data.indication || "暂无适应症";
                document.getElementById('drug-mechanism').textContent = data.mechanismOfAction || "暂无信息";
                document.getElementById('drug-pharmacodynamics').textContent = data.pharmacodynamics || "暂无数据";
                document.getElementById('drug-group').textContent = data.groupName || "暂无分组";
                
                // 默认图片路径，直接拼接 dbId
                document.getElementById('drug-image').src = `https://go.drugbank.com/structures/${data.dbId}/thumb.svg`;
            })
            .catch(error => {
                console.error('获取药物详情失败:', error);
            });
    }
</script>

</body>
</html>
